# language: ru
Функционал: Аутентификация пользователя

Контекст:
Дано сервер приложения доступен по адресу "http://localhost:8080"
И заголовок X-Api-Key установлен в "qazWSXedc"

Сценарий: Успешная аутентификация пользователя
Когда пользователь отправляет запрос с действием "LOGIN" и корректным токеном
И внешний сервис аутентификации возвращает успешный ответ
Тогда система возвращает результат "OK"
И токен сохраняется в системе для будущих действий

Сценарий: Аутентификация с некорректным токеном (неправильная длина)
Когда пользователь отправляет запрос с действием "LOGIN" и токеном короче 32 символов
Тогда система возвращает результат "ERROR"
И сообщение об ошибке содержит описание проблемы

Сценарий: Аутентификация с некорректным токеном (недопустимые символы)
Когда пользователь отправляет запрос с действием "LOGIN" и токеном с символами в нижнем регистре
Тогда система возвращает результат "ERROR"
И сообщение об ошибке содержит описание проблемы

Сценарий: Аутентификация при недоступности внешнего сервиса
Когда пользователь отправляет запрос с действием "LOGIN" и корректным токеном
И внешний сервис аутентификации возвращает ошибку
Тогда система возвращает результат "ERROR"
И сообщение об ошибке содержит описание проблемы

Сценарий: Аутентификация без обязательного токена
Когда пользователь отправляет запрос с действием "LOGIN" без указания токена
Тогда система возвращает результат "ERROR"
И сообщение об ошибке содержит описание проблемы

Сценарий: Аутентификация с неправильным API-ключом
Дано заголовок X-Api-Key установлен в "неправильный_ключ"
Когда пользователь отправляет запрос с действием "LOGIN" и корректным токеном
Тогда система возвращает ошибку доступа