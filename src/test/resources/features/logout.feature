# language: ru
@logout @security
Функционал: Завершение сессии пользователя
  Пользователь должен иметь возможность безопасно завершить свою сессию в системе

  Контекст:
    Дано сервер приложения доступен
    И заголовок X-Api-Key установлен в "A94F2C7D8E1B4A6F9C3D2E5B8A7F1C0D"

  @smoke
  Сценарий: Успешное завершение сессии аутентифицированного пользователя
    Дано пользователь успешно аутентифицирован с токеном
    Когда пользователь отправляет запрос с действием "LOGOUT" и аутентифицированным токеном
    Тогда система возвращает результат "OK"

  @negative
  Сценарий: Попытка завершить сессию без предварительной аутентификации
    Когда пользователь отправляет запрос с действием "LOGOUT" с токеном, который не проходил LOGIN
    Тогда система возвращает результат "ERROR"

  @negative
  Сценарий: Повторное завершение уже завершенной сессии
    Дано пользователь успешно аутентифицирован с токеном
    И пользователь завершил сессию
    Когда пользователь повторно отправляет запрос с действием "LOGOUT" с тем же токеном
    Тогда система возвращает результат "ERROR"